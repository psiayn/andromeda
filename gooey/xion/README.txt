Some fancy stuff I found about simulating a large number of particles.
Not my code.